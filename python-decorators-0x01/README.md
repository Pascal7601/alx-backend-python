Using PYTHON decorators to optimize sql queries